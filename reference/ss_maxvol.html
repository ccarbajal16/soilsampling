<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maxvol Optimal Design Sampling — ss_maxvol • soilsampling</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maxvol Optimal Design Sampling — ss_maxvol"><meta name="description" content="Generates sampling points using the maxvol algorithm, which selects
locations by maximizing the determinant (volume) of a feature submatrix.
This is a D-optimal design approach that selects points with the most
diverse feature characteristics."><meta property="og:description" content="Generates sampling points using the maxvol algorithm, which selects
locations by maximizing the determinant (volume) of a feature submatrix.
This is a D-optimal design approach that selects points with the most
diverse feature characteristics."><meta property="og:image" content="https://ccarbajal16.github.io/soilsampling/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">soilsampling</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction to soilsampling</a></li>
    <li><a class="dropdown-item" href="../articles/spatial-coverage.html">Spatial Coverage Sampling</a></li>
    <li><a class="dropdown-item" href="../articles/maxvol-sampling.html">Maxvol Optimal Design Sampling</a></li>
    <li><a class="dropdown-item" href="../articles/user-guide.html">User Guide</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ccarbajal16/soilsampling"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Maxvol Optimal Design Sampling</h1>
      <small class="dont-index">Source: <a href="https://github.com/ccarbajal16/soilsampling/blob/main/R/maxvol.R" class="external-link"><code>R/maxvol.R</code></a></small>
      <div class="d-none name"><code>ss_maxvol.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates sampling points using the maxvol algorithm, which selects
locations by maximizing the determinant (volume) of a feature submatrix.
This is a D-optimal design approach that selects points with the most
diverse feature characteristics.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ss_maxvol</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">n</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coords <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_dist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_coords <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1.1</span>,</span>
<span>  max_iters <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An <code>sf</code> object representing the study area with feature attributes,
OR a numeric matrix of features (rows = locations, columns = features).</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Integer, the number of sampling points to select.</p></dd>


<dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>Character vector of feature names to use from <code>x</code> if it's
an sf object. If NULL, all numeric attributes are used.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>Matrix (n_locations x 2) of coordinates. Required if <code>x</code> is
a matrix. If <code>x</code> is sf, coordinates are extracted automatically.</p></dd>


<dt id="arg-min-dist">min_dist<a class="anchor" aria-label="anchor" href="#arg-min-dist"></a></dt>
<dd><p>Numeric, minimum distance between sampling points. If NULL,
no distance constraint is applied.</p></dd>


<dt id="arg-normalize">normalize<a class="anchor" aria-label="anchor" href="#arg-normalize"></a></dt>
<dd><p>Logical, whether to normalize features before applying
maxvol (default TRUE). Recommended when features have different scales.</p></dd>


<dt id="arg-add-coords">add_coords<a class="anchor" aria-label="anchor" href="#arg-add-coords"></a></dt>
<dd><p>Logical, whether to add coordinates as features (default
TRUE). This helps balance feature space and geographic space.</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>Numeric, convergence tolerance for maxvol algorithm (default 1.1).</p></dd>


<dt id="arg-max-iters">max_iters<a class="anchor" aria-label="anchor" href="#arg-max-iters"></a></dt>
<dd><p>Integer, maximum iterations for maxvol (default 100).</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical, whether to print progress messages (default FALSE).</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional integer seed for reproducibility.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>ss_samples</code> containing:</p><dl><dt>samples</dt>
<dd><p>An <code>sf</code> object with the sampling points.</p></dd>

<dt>method</dt>
<dd><p>Character, "maxvol".</p></dd>

<dt>n_samples</dt>
<dd><p>Integer, number of samples.</p></dd>

<dt>features_used</dt>
<dd><p>Character vector of feature names used.</p></dd>

<dt>converged</dt>
<dd><p>Logical, whether maxvol converged.</p></dd>

<dt>iterations</dt>
<dd><p>Integer, number of maxvol iterations.</p></dd>

<dt>crs</dt>
<dd><p>The coordinate reference system.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The maxvol algorithm selects sampling locations by finding a submatrix
of the feature matrix with approximately maximum determinant (volume).
Geometrically, this maximizes the volume of the parallelepiped spanned
by the selected feature vectors, ensuring that sampled locations have
maximal diversity in feature space.</p>
<p>The algorithm is based on D-optimal experimental design and is particularly
effective when:</p><ul><li><p>Features explain the main soil-forming factors</p></li>
<li><p>You want deterministic (non-random) point selection</p></li>
<li><p>You need optimal coverage with few samples</p></li>
</ul><p><strong>Feature Selection:</strong>
Terrain features typically used include:</p><ul><li><p>Elevation</p></li>
<li><p>Slope</p></li>
<li><p>Aspect</p></li>
<li><p>Topographic Wetness Index (TWI)</p></li>
<li><p>Closed depressions</p></li>
<li><p>Flow accumulation</p></li>
</ul><p><strong>Distance Constraint:</strong>
The <code>min_dist</code> parameter prevents spatial clustering. Points closer than
this distance will not be selected together. The value should be chosen
based on:</p><ul><li><p>Study area size</p></li>
<li><p>Terrain ruggedness (more rugged = smaller min_dist)</p></li>
<li><p>Typical size of soil mapping units</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Petrovskaia, A., Ryzhakov, G., &amp; Oseledets, I. (2021). Optimal soil
sampling design based on the maxvol algorithm. Geoderma, 383, 114733.
<a href="https://doi.org/10.1016/j.geoderma.2020.114733" class="external-link">doi:10.1016/j.geoderma.2020.114733</a></p>
<p>Goreinov, S. A., Oseledets, I. V., Savostyanov, D. V., Tyrtyshnikov, E. E.,
&amp; Zamarashkin, N. L. (2010). How to find a good submatrix. In Matrix
Methods: Theory, Algorithms And Applications (pp. 247-256). World Scientific.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ss_coverage.html">ss_coverage()</a></code>, <code><a href="ss_stratified.html">ss_stratified()</a></code>, <code><a href="ss_random.html">ss_random()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a study area with feature attributes</span></span></span>
<span class="r-in"><span><span class="va">poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">study_area</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="va">poly</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In practice, you would load terrain features from a DEM</span></span></span>
<span class="r-in"><span><span class="co"># For this example, we'll use stratification cells with computed features</span></span></span>
<span class="r-in"><span><span class="va">strata</span> <span class="op">&lt;-</span> <span class="fu"><a href="ss_stratify.html">ss_stratify</a></span><span class="op">(</span><span class="va">study_area</span>, n_strata <span class="op">=</span> <span class="fl">100</span>, n_try <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add terrain-like features to cells</span></span></span>
<span class="r-in"><span><span class="va">cells_sf</span> <span class="op">&lt;-</span> <span class="va">strata</span><span class="op">$</span><span class="va">cells</span></span></span>
<span class="r-in"><span><span class="va">coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">cells_sf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells_sf</span><span class="op">$</span><span class="va">elevation</span> <span class="op">&lt;-</span> <span class="va">coords</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>, <span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cells_sf</span><span class="op">$</span><span class="va">slope</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">coords</span><span class="op">)</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select 20 sampling points using maxvol</span></span></span>
<span class="r-in"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu">ss_maxvol</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">cells_sf</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"elevation"</span>, <span class="st">"slope"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  min_dist <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  add_coords <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ss_plot_samples.html">ss_plot_samples</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/ccarbajal16" class="external-link">Carlos Carbajal</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

