[{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Introduction to soilsampling","text":"soilsampling package provides methods designing soil sampling schemes, including: Simple Random Sampling: Uniform random selection sampling locations Stratified Random Sampling: Random sampling within compact geographical strata Spatial Coverage Sampling: Purposive sampling stratum centroids optimal coverage Maxvol Optimal Design: D-optimal design using maximum volume criterion Composite Sampling: Sampling equal-area strata combined samples package uses sf spatial operations implements pure R algorithms, requiring Java additional GIS software.","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Introduction to soilsampling","text":"","code":"# Install from local source install.packages(\".\", repos = NULL, type = \"source\")  # Or using devtools devtools::install()"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"quick-start","dir":"Articles","previous_headings":"","what":"Quick Start","title":"Introduction to soilsampling","text":"","code":"library(soilsampling) library(sf)  # Create a study area poly <- st_polygon(list(rbind(   c(0, 0), c(100, 0), c(100, 50), c(0, 50), c(0, 0) ))) study_area <- st_sf(geometry = st_sfc(poly))"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"spatial-coverage-sampling","dir":"Articles","previous_headings":"Quick Start","what":"Spatial Coverage Sampling","title":"Introduction to soilsampling","text":"","code":"# Set seed for reproducibility set.seed(42)  # Create spatial coverage sampling design samples_coverage <- ss_coverage(study_area, n_strata = 25, n_try = 5)  # View summary print(samples_coverage) #> Spatial Coverage Sampling  #> =========================  #> Number of samples: 25  #> Number of strata: 25  # Plot ss_plot(samples_coverage)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"stratified-random-sampling","dir":"Articles","previous_headings":"Quick Start","what":"Stratified Random Sampling","title":"Introduction to soilsampling","text":"","code":"# First create strata strata <- ss_stratify(study_area, n_strata = 25, n_try = 5)  # Take random samples within each stratum samples_stratified <- ss_stratified(strata, n_per_stratum = 1)  # Plot ss_plot(strata, samples = samples_stratified)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"simple-random-sampling","dir":"Articles","previous_headings":"Quick Start","what":"Simple Random Sampling","title":"Introduction to soilsampling","text":"","code":"# Simple random sampling samples_random <- ss_random(study_area, n = 25)  # Plot ss_plot_samples(samples_random)"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"as-data-frame","dir":"Articles","previous_headings":"Exporting Results","what":"As Data Frame","title":"Introduction to soilsampling","text":"","code":"# Get coordinates as data frame coords <- ss_to_data_frame(samples_coverage) head(coords) #>   sample_id stratum_id is_prior        X        Y #> 1         1          1    FALSE 35.02039 46.55740 #> 2         2          2    FALSE 55.66225 23.53371 #> 3         3          3    FALSE 46.77691 22.27986 #> 4         4          4    FALSE 62.12984 27.15672 #> 5         5          5    FALSE 92.47119 10.56665 #> 6         6          6    FALSE 52.60995 40.20839"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"as-csv","dir":"Articles","previous_headings":"Exporting Results","what":"As CSV","title":"Introduction to soilsampling","text":"","code":"# Export to CSV write.csv(coords, \"sampling_points.csv\", row.names = FALSE)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"as-shapefile-or-geopackage","dir":"Articles","previous_headings":"Exporting Results","what":"As Shapefile or GeoPackage","title":"Introduction to soilsampling","text":"","code":"# Get as sf object samples_sf <- ss_to_sf(samples_coverage)  # Export to GeoPackage st_write(samples_sf, \"sampling_points.gpkg\")  # Export to Shapefile st_write(samples_sf, \"sampling_points.shp\")"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"working-with-real-data","dir":"Articles","previous_headings":"","what":"Working with Real Data","title":"Introduction to soilsampling","text":"practice, load study area shapefile:","code":"# Read study area from shapefile study_area <- st_read(\"path/to/study_area.shp\")  # Create sampling design set.seed(42) samples <- ss_coverage(study_area, n_strata = 50, n_try = 10)  # Export coordinates coords <- ss_to_data_frame(samples) write.csv(coords, \"field_sampling_points.csv\", row.names = FALSE)"},{"path":[]},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"design-based-vs-model-based","dir":"Articles","previous_headings":"Sampling Methods Comparison","what":"Design-Based vs Model-Based","title":"Introduction to soilsampling","text":"Design-based sampling (e.g., ss_random(), ss_stratified()): - Uses probability sampling - Statistical inference based sampling design - Valid design-based estimation (means, totals) - assumptions spatial autocorrelation required Model-based sampling (e.g., ss_coverage(), ss_maxvol()): - Purposive (non-random) sample selection - Requires spatial model inference (e.g., kriging) - Optimal prediction interpolation - efficient mapping applications","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"tips-for-best-results","dir":"Articles","previous_headings":"","what":"Tips for Best Results","title":"Introduction to soilsampling","text":"Use multiple tries: Set n_try = 10 higher avoid local optima k-means algorithms Set seed: Use set.seed() reproducible results Adjust resolution: Use n_cells parameter control grid density Check convergence: output includes converged flag Consider prior information: Use prior_points incorporate existing sample locations","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"getting-help","dir":"Articles","previous_headings":"","what":"Getting Help","title":"Introduction to soilsampling","text":"detailed information specific methods, see: vignette(\"spatial-coverage\") - Spatial coverage sampling methods vignette(\"maxvol-sampling\") - Maxvol optimal design sampling ?ss_stratify - Help stratification ?ss_coverage - Help coverage sampling ?ss_maxvol - Help maxvol sampling","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/introduction.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Introduction to soilsampling","text":"de Gruijter, J.J., Brus, D.J., Bierkens, M.F.P., Knotters, M. (2006). Sampling Natural Resource Monitoring. Springer, Berlin. Walvoort, D.J.J., Brus, D.J., de Gruijter, J.J. (2010). R package spatial coverage sampling random sampling compact geographical strata k-means. Computers & Geosciences 36, 1261-1267. Petrovskaia, ., Ryzhakov, G., & Oseledets, . (2021). Optimal soil sampling design based maxvol algorithm. Geoderma, 383, 114733.","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Maxvol Optimal Design Sampling","text":"maxvol algorithm D-optimal design method selecting sampling locations maximizing determinant (volume) feature submatrix. Unlike traditional probability-based sampling, maxvol takes deterministic optimal design approach selects locations maximum diversity feature space. method particularly effective : Features explain soil variability: Terrain attributes correlate soil properties Deterministic selection preferred: Non-random, reproducible point placement samples available: Optimal coverage minimal sampling effort Model-based inference planned: Kriging machine learning predictions","code":""},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"the-maximum-volume-principle","dir":"Articles","previous_headings":"Theoretical Background","what":"The Maximum Volume Principle","title":"Maxvol Optimal Design Sampling","text":"Given matrix ð€\\mathbf{} size mÃ—nm \\times n (mm represents locations nn represents features), maxvol algorithm selects kk rows form submatrix ð€Ì‚\\hat{\\mathbf{}} approximately maximum determinant: ð€Ì‚=argmaxsubmatrix|det(ð€k)| \\hat{\\mathbf{}} = \\arg\\max_{\\text{submatrix}} |\\det(\\mathbf{}_k)| Geometrically, determinant represents volume nn-dimensional parallelepiped spanned row vectors. Maximizing volume ensures selected locations maximal diversity feature space.","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"d-optimal-design","dir":"Articles","previous_headings":"Theoretical Background","what":"D-Optimal Design","title":"Maxvol Optimal Design Sampling","text":"maxvol algorithm implements D-optimal experimental design, minimizes determinant covariance matrix parameter estimates. practical terms, D-optimal designs: Spread samples across feature space Minimize correlation sample locations feature space Maximize information parameter estimation","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"algorithm-steps","dir":"Articles","previous_headings":"Theoretical Background","what":"Algorithm Steps","title":"Maxvol Optimal Design Sampling","text":"Feature Matrix Construction: Create matrix ð€\\mathbf{} row represents location columns represent features (elevation, slope, TWI, etc.) Normalization (optional): Standardize features zero mean unit variance Rectangular Maxvol (rect_maxvol): Initialize kk random rows Compute coefficient matrix ð=ð€â‹…ð€Ì‚âˆ’1\\mathbf{B} = \\mathbf{} \\cdot \\hat{\\mathbf{}}^{-1} Iteratively swap rows maximize volume Apply distance constraints specified Point Selection: Selected row indices correspond sampling locations","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"basic-usage","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Maxvol Optimal Design Sampling","text":"","code":"library(soilsampling) library(sf)  # Create a study area with terrain features poly <- st_polygon(list(rbind(   c(0, 0), c(100, 0), c(100, 50), c(0, 50), c(0, 0) ))) study_area <- st_sf(geometry = st_sfc(poly))  # In practice, you would compute features from a DEM # For this example, we'll create a grid with synthetic features set.seed(42)  # Create fine grid to represent potential sampling locations grid <- st_make_grid(study_area, cellsize = c(2.5, 2.5), what = \"centers\") grid_sf <- st_sf(geometry = grid) grid_sf <- grid_sf[st_intersects(grid_sf, study_area, sparse = FALSE)[,1], ]  # Add synthetic terrain features coords <- st_coordinates(grid_sf) grid_sf$elevation <- coords[,2] + 10 * sin(coords[,1] / 20) + rnorm(nrow(coords), 0, 2) grid_sf$slope <- abs(cos(coords[,1] / 15) * 5 + rnorm(nrow(coords), 0, 1)) grid_sf$twi <- 10 - grid_sf$slope + rnorm(nrow(coords), 0, 0.5) grid_sf$aspect <- (atan2(coords[,2] - 25, coords[,1] - 50) + pi) / (2 * pi) * 360"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"simple-maxvol-sampling","dir":"Articles","previous_headings":"Basic Usage","what":"Simple Maxvol Sampling","title":"Maxvol Optimal Design Sampling","text":"","code":"# Select 20 sampling points using maxvol samples_maxvol <- ss_maxvol(   grid_sf,   n = 20,   features = c(\"elevation\", \"slope\", \"twi\", \"aspect\"),   normalize = TRUE,   add_coords = TRUE )  print(samples_maxvol) #> NA  #> NA  #> Number of samples: 20  # Plot results ss_plot_samples(samples_maxvol)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"with-distance-constraint","dir":"Articles","previous_headings":"Basic Usage","what":"With Distance Constraint","title":"Maxvol Optimal Design Sampling","text":"avoid spatial clustering, apply minimum distance constraint:","code":"# Select points with minimum 10-unit spacing samples_constrained <- ss_maxvol(   grid_sf,   n = 20,   features = c(\"elevation\", \"slope\", \"twi\"),   min_dist = 10,   normalize = TRUE,   add_coords = TRUE )  ss_plot_samples(samples_constrained)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"feature-selection","dir":"Articles","previous_headings":"","what":"Feature Selection","title":"Maxvol Optimal Design Sampling","text":"choice features crucial maxvol performance. Common terrain features soil sampling:","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"topographic-features","dir":"Articles","previous_headings":"Feature Selection","what":"Topographic Features","title":"Maxvol Optimal Design Sampling","text":"","code":"# Terrain features commonly used in pedometrics features_topo <- c(   \"elevation\",      # Height above reference   \"slope\",          # Rate of elevation change   \"aspect\",         # Direction of slope   \"twi\"             # Topographic Wetness Index )  # Other useful features (if computed from DEM): # - Curvature (plan, profile) # - Flow accumulation # - Closed depressions # - Topographic Position Index (TPI) # - Terrain Ruggedness Index (TRI)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"adding-coordinates","dir":"Articles","previous_headings":"Feature Selection","what":"Adding Coordinates","title":"Maxvol Optimal Design Sampling","text":"Including coordinates features balances feature space geographic space:","code":"# Without coordinates: purely feature-based samples_no_coords <- ss_maxvol(   grid_sf,   n = 20,   features = c(\"elevation\", \"slope\"),   add_coords = FALSE,   normalize = TRUE )  # With coordinates: balances features and geography samples_with_coords <- ss_maxvol(   grid_sf,   n = 20,   features = c(\"elevation\", \"slope\"),   add_coords = TRUE,  # Default   normalize = TRUE )  par(mfrow = c(1, 2)) plot(st_geometry(study_area), main = \"Without Coordinates\") plot(st_geometry(samples_no_coords$samples), add = TRUE, pch = 19, col = \"red\")  plot(st_geometry(study_area), main = \"With Coordinates\") plot(st_geometry(samples_with_coords$samples), add = TRUE, pch = 19, col = \"blue\") par(mfrow = c(1, 1))"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"feature-normalization","dir":"Articles","previous_headings":"","what":"Feature Normalization","title":"Maxvol Optimal Design Sampling","text":"Normalization important features different scales: Recommendation: Always use normalize = TRUE unless features already similar scales.","code":"# Check feature scales summary(grid_sf[, c(\"elevation\", \"slope\", \"twi\")]) #>    elevation          slope              twi            geometry   #>  Min.   :-13.53   Min.   :0.01217   Min.   : 1.527   POINT  :800   #>  1st Qu.: 13.97   1st Qu.:2.05764   1st Qu.: 5.293   epsg:NA:  0   #>  Median : 26.67   Median :3.56345   Median : 6.490                 #>  Mean   : 26.33   Mean   :3.36774   Mean   : 6.644                 #>  3rd Qu.: 38.62   3rd Qu.:4.58750   3rd Qu.: 7.998                 #>  Max.   : 61.51   Max.   :8.34239   Max.   :11.528  # Without normalization: features with larger variance dominate samples_raw <- ss_maxvol(   grid_sf,   n = 15,   features = c(\"elevation\", \"slope\", \"twi\"),   normalize = FALSE,   add_coords = FALSE )  # With normalization: equal weight to all features samples_norm <- ss_maxvol(   grid_sf,   n = 15,   features = c(\"elevation\", \"slope\", \"twi\"),   normalize = TRUE,  # Recommended   add_coords = FALSE )"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"distance-constraint-tuning","dir":"Articles","previous_headings":"","what":"Distance Constraint Tuning","title":"Maxvol Optimal Design Sampling","text":"distance constraint prevents spatial clustering features vary locally:","code":"# No distance constraint samples_no_dist <- ss_maxvol(   grid_sf,   n = 20,   features = c(\"elevation\", \"slope\", \"twi\"),   min_dist = NULL )  # Small distance constraint samples_small_dist <- ss_maxvol(   grid_sf,   n = 20,   features = c(\"elevation\", \"slope\", \"twi\"),   min_dist = 5 )  # Large distance constraint samples_large_dist <- ss_maxvol(   grid_sf,   n = 20,   features = c(\"elevation\", \"slope\", \"twi\"),   min_dist = 15 )  par(mfrow = c(1, 3)) plot(st_geometry(study_area), main = \"No constraint\") plot(st_geometry(samples_no_dist$samples), add = TRUE, pch = 19, col = \"red\", cex = 0.8)  plot(st_geometry(study_area), main = \"min_dist = 5\") plot(st_geometry(samples_small_dist$samples), add = TRUE, pch = 19, col = \"blue\", cex = 0.8)  plot(st_geometry(study_area), main = \"min_dist = 15\") plot(st_geometry(samples_large_dist$samples), add = TRUE, pch = 19, col = \"green\", cex = 0.8) par(mfrow = c(1, 1))"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"choosing-min_dist","dir":"Articles","previous_headings":"Distance Constraint Tuning","what":"Choosing min_dist","title":"Maxvol Optimal Design Sampling","text":"Guidelines setting distance constraint: Study area size: Larger areas â†’ larger min_dist Terrain ruggedness: rugged â†’ smaller min_dist (features vary locally) Sample size: samples â†’ smaller min_dist Soil mapping unit size: Use typical minimum mapping unit diameter","code":"# Rule of thumb: min_dist = (study area extent) / (2 * sqrt(n_samples)) bbox <- st_bbox(study_area) extent <- sqrt((bbox$xmax - bbox$xmin) * (bbox$ymax - bbox$ymin)) n_samples <- 20 suggested_min_dist <- extent / (2 * sqrt(n_samples))  cat(\"Suggested min_dist:\", round(suggested_min_dist, 1), \"\\n\") #> Suggested min_dist: 7.9"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"comparison-with-other-methods","dir":"Articles","previous_headings":"","what":"Comparison with Other Methods","title":"Maxvol Optimal Design Sampling","text":"","code":"set.seed(123)  # Maxvol sampling samp_maxvol <- ss_maxvol(   grid_sf,   n = 25,   features = c(\"elevation\", \"slope\", \"twi\"),   min_dist = 8,   normalize = TRUE )  # Spatial coverage (k-means based) samp_coverage <- ss_coverage(study_area, n_strata = 25, n_try = 5)  # Simple random samp_random <- ss_random(study_area, n = 25)  par(mfrow = c(1, 3))  plot(st_geometry(study_area), main = \"Maxvol (Feature-based)\") plot(st_geometry(samp_maxvol$samples), add = TRUE, pch = 19, col = \"red\")  plot(st_geometry(study_area), main = \"Coverage (Geography-based)\") plot(st_geometry(samp_coverage$samples), add = TRUE, pch = 19, col = \"blue\")  plot(st_geometry(study_area), main = \"Random\") plot(st_geometry(samp_random$samples), add = TRUE, pch = 19, col = \"green\") par(mfrow = c(1, 1))"},{"path":[]},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"step-1-prepare-feature-data","dir":"Articles","previous_headings":"Practical Workflow","what":"Step 1: Prepare Feature Data","title":"Maxvol Optimal Design Sampling","text":"","code":"library(terra)  # For raster processing  # Load DEM dem <- rast(\"path/to/dem.tif\")  # Compute terrain features slope <- terrain(dem, \"slope\") aspect <- terrain(dem, \"aspect\") tpi <- terrain(dem, \"TPI\") tri <- terrain(dem, \"TRI\")  # Compute TWI (requires flow direction) # ... (depends on your workflow)  # Stack features features_stack <- c(dem, slope, aspect, tpi, tri)  # Convert to points feature_points <- as.points(features_stack) feature_sf <- st_as_sf(feature_points)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"step-2-run-maxvol","dir":"Articles","previous_headings":"Practical Workflow","what":"Step 2: Run Maxvol","title":"Maxvol Optimal Design Sampling","text":"","code":"# Select sampling points samples <- ss_maxvol(   feature_sf,   n = 50,   features = c(\"elevation\", \"slope\", \"aspect\", \"tpi\", \"tri\"),   min_dist = 100,  # meters, adjust for your study   normalize = TRUE,   add_coords = TRUE,   verbose = TRUE )  # Check convergence if (!samples$converged) {   warning(\"Maxvol did not converge. Consider increasing max_iters.\") }"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"step-3-export-results","dir":"Articles","previous_headings":"Practical Workflow","what":"Step 3: Export Results","title":"Maxvol Optimal Design Sampling","text":"","code":"# Get coordinates coords <- ss_to_data_frame(samples)  # Export for field work write.csv(coords, \"maxvol_sampling_points.csv\", row.names = FALSE)  # Export as GeoPackage st_write(ss_to_sf(samples), \"maxvol_points.gpkg\")"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"custom-feature-matrix","dir":"Articles","previous_headings":"Advanced Usage","what":"Custom Feature Matrix","title":"Maxvol Optimal Design Sampling","text":"can provide feature matrix:","code":"# Create custom feature matrix coords_mat <- st_coordinates(grid_sf) n_loc <- nrow(coords_mat)  custom_features <- matrix(   c(     grid_sf$elevation,     grid_sf$slope,     grid_sf$twi   ),   ncol = 3 ) colnames(custom_features) <- c(\"elev\", \"slope\", \"twi\")  # Use with maxvol samples_custom <- ss_maxvol(   custom_features,   n = 20,   coords = coords_mat,   normalize = TRUE )"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"integration-with-existing-functions","dir":"Articles","previous_headings":"Advanced Usage","what":"Integration with Existing Functions","title":"Maxvol Optimal Design Sampling","text":"Maxvol can complement existing sampling schemes:","code":"# Use maxvol to densify an existing sample # Suppose we have prior samples prior_samples <- ss_random(study_area, n = 5)  # Use stratification to avoid prior samples # Then use maxvol for additional points # (This would require custom code to exclude prior locations)"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"algorithm-complexity","dir":"Articles","previous_headings":"Performance Considerations","what":"Algorithm Complexity","title":"Maxvol Optimal Design Sampling","text":"Time complexity: O(kâ‹…mâ‹…n2â‹…iterations)O(k \\cdot m \\cdot n^2 \\cdot \\text{iterations}) Space complexity: O(mâ‹…n)O(m \\cdot n) : - mm = number candidate locations - nn = number features - kk = number samples select","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"computational-tips","dir":"Articles","previous_headings":"Performance Considerations","what":"Computational Tips","title":"Maxvol Optimal Design Sampling","text":"","code":"# For large datasets, reduce candidate locations # Option 1: Coarser grid grid_coarse <- st_make_grid(study_area, cellsize = c(5, 5), what = \"centers\")  # Option 2: Pre-filter using simpler criteria # (e.g., remove unsuitable areas)  # Option 3: Sample from candidate pool candidate_sample <- grid_sf[sample(nrow(grid_sf), 500), ]"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"when-to-use-maxvol","dir":"Articles","previous_headings":"","what":"When to Use Maxvol","title":"Maxvol Optimal Design Sampling","text":"âœ… Use maxvol : Features strongly correlate target variable want deterministic, reproducible sampling Feature diversity important geographic spread Sample size limited â€™re model-based inference (kriging, ML) âŒ Donâ€™t use maxvol : need probability-based sampling unbiased estimation Features donâ€™t explain target variable well Pure geographic coverage goal need strictly random samples","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/maxvol-sampling.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Maxvol Optimal Design Sampling","text":"Petrovskaia, ., Ryzhakov, G., & Oseledets, . (2021). Optimal soil sampling design based maxvol algorithm. Geoderma, 383, 114733. DOI: 10.1016/j.geoderma.2020.114733 Goreinov, S. ., Oseledets, . V., Savostyanov, D. V., Tyrtyshnikov, E. E., & Zamarashkin, N. L. (2010). find good submatrix. Matrix Methods: Theory, Algorithms Applications (pp.Â 247-256). World Scientific. Fedorov, V. (1972). Theory Optimal Experiments. Academic Press. Walvoort, D.J.J., Brus, D.J., de Gruijter, J.J. (2010). R package spatial coverage sampling random sampling compact geographical strata k-means. Computers & Geosciences, 36, 1261-1267.","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Spatial Coverage Sampling Methods","text":"Spatial coverage sampling aims provide optimal spatial distribution sampling points across study area. soilsampling package implements spatial coverage using k-means clustering create compact geographical strata, samples placed stratum centroids. approach particularly effective : Model-based inference: Kriging spatial interpolation Soil mapping: Creating detailed soil maps Environmental monitoring: Capturing spatial variability Resource assessment: Estimating spatial distributions","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"theoretical-background","dir":"Articles","previous_headings":"","what":"Theoretical Background","title":"Spatial Coverage Sampling Methods","text":"spatial coverage method based : K-means clustering geographic space create compact strata Stratification minimizes Mean Squared Shortest Distance (MSSD) Centroid sampling optimal spatial coverage k-means algorithm partitions study area compact spatial strata minimizing: MSSD=1mâˆ‘=1mminkd2(xi,ck) \\text{MSSD} = \\frac{1}{m}\\sum_{=1}^{m} \\min_k d^2(x_i, c_k) xix_i grid cell centers, ckc_k stratum centroids, dd Euclidean distance (haversine distance lat/lon coordinates).","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"basic-usage","dir":"Articles","previous_headings":"","what":"Basic Usage","title":"Spatial Coverage Sampling Methods","text":"","code":"library(soilsampling) library(sf)  # Create a study area poly <- st_polygon(list(rbind(   c(0, 0), c(100, 0), c(100, 50), c(0, 50), c(0, 0) ))) study_area <- st_sf(geometry = st_sfc(poly))  # Set seed for reproducibility set.seed(123)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"direct-coverage-sampling","dir":"Articles","previous_headings":"Basic Usage","what":"Direct Coverage Sampling","title":"Spatial Coverage Sampling Methods","text":"","code":"# Create 25 coverage samples in one step samples <- ss_coverage(study_area, n_strata = 25, n_try = 5)  print(samples) #> Spatial Coverage Sampling  #> =========================  #> Number of samples: 25  #> Number of strata: 25"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"two-step-approach","dir":"Articles","previous_headings":"Basic Usage","what":"Two-Step Approach","title":"Spatial Coverage Sampling Methods","text":"","code":"# Step 1: Create stratification strata <- ss_stratify(study_area, n_strata = 25, n_try = 5)  print(strata) #> Soil Sampling Stratification #> ============================ #> Number of strata: 25  #> Number of cells: 2485  #> Cell size: 1.41 x 1.41  #> MSSD: 42.7747  #> Converged: TRUE  #> Equal area: FALSE  # Step 2: Extract centroids as sampling points samples <- ss_coverage(strata)  # Plot both strata and samples ss_plot(strata, samples = samples)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"algorithm-variants","dir":"Articles","previous_headings":"","what":"Algorithm Variants","title":"Spatial Coverage Sampling Methods","text":"package implements two k-means variants:","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"transfer-algorithm-default","dir":"Articles","previous_headings":"Algorithm Variants","what":"1. Transfer Algorithm (Default)","title":"Spatial Coverage Sampling Methods","text":"Creates compact strata may unequal sizes:","code":"# Standard spatial coverage samples_transfer <- ss_coverage(study_area, n_strata = 20, n_try = 5)  # Check stratum sizes strata_transfer <- ss_stratify(study_area, n_strata = 20, n_try = 5) areas <- ss_relative_area(strata_transfer) summary(areas) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #> 0.01730 0.02897 0.04547 0.05000 0.06539 0.09819"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"swop-algorithm-equal-area","dir":"Articles","previous_headings":"Algorithm Variants","what":"2. Swop Algorithm (Equal Area)","title":"Spatial Coverage Sampling Methods","text":"Creates strata approximately equal size: equal-area variant particularly useful composite sampling need equal representation stratum.","code":"# Equal-area coverage sampling samples_equal <- ss_coverage_equal_area(study_area, n_strata = 20, n_try = 5)  # Check stratum sizes strata_equal <- ss_stratify(   study_area,   n_strata = 20,   n_try = 5,   equal_area = TRUE ) areas_equal <- ss_relative_area(strata_equal) summary(areas_equal) #>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.  #>  0.0499  0.0499  0.0499  0.0500  0.0500  0.0503"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"incorporating-prior-points","dir":"Articles","previous_headings":"","what":"Incorporating Prior Points","title":"Spatial Coverage Sampling Methods","text":"can incorporate existing sampling locations fixed stratum centers:  Prior points useful : - Adding existing monitoring network - Incorporating legacy sampling locations - Designing adaptive sampling schemes","code":"# Suppose we have 2 existing sampling locations prior_pts <- st_as_sf(   data.frame(x = c(25, 75), y = c(25, 25)),   coords = c(\"x\", \"y\") )  # Create stratification with prior points strata_prior <- ss_stratify(   study_area,   n_strata = 20,   prior_points = prior_pts,   n_try = 5 )  # Get coverage samples samples_prior <- ss_coverage(strata_prior)  # Plot with prior points highlighted ss_plot(samples_prior)"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"number-of-strata","dir":"Articles","previous_headings":"Optimizing Parameters","what":"Number of Strata","title":"Spatial Coverage Sampling Methods","text":"choice n_strata depends : Survey budget: strata = samples Spatial variability: heterogeneous areas need samples Mapping resolution: Finer maps need samples","code":"# Compare different numbers of strata samples_10 <- ss_coverage(study_area, n_strata = 10, n_try = 5) samples_50 <- ss_coverage(study_area, n_strata = 50, n_try = 5)  par(mfrow = c(1, 2)) plot(st_geometry(study_area), main = \"10 strata\") plot(st_geometry(samples_10$samples), add = TRUE, pch = 19, col = \"red\")  plot(st_geometry(study_area), main = \"50 strata\") plot(st_geometry(samples_50$samples), add = TRUE, pch = 19, col = \"red\") par(mfrow = c(1, 1))"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"number-of-tries","dir":"Articles","previous_headings":"Optimizing Parameters","what":"Number of Tries","title":"Spatial Coverage Sampling Methods","text":"n_try parameter controls many random initializations use: Higher n_try generally produces better results takes longer.","code":"# Compare convergence with different n_try values set.seed(456) result_1 <- ss_stratify(study_area, n_strata = 25, n_try = 1) result_5 <- ss_stratify(study_area, n_strata = 25, n_try = 5) result_20 <- ss_stratify(study_area, n_strata = 25, n_try = 20)  cat(\"n_try = 1:  MSSD =\", format(result_1$mssd, digits = 6), \"\\n\") #> n_try = 1:  MSSD = 44.7988 cat(\"n_try = 5:  MSSD =\", format(result_5$mssd, digits = 6), \"\\n\") #> n_try = 5:  MSSD = 42.2537 cat(\"n_try = 20: MSSD =\", format(result_20$mssd, digits = 6), \"\\n\") #> n_try = 20: MSSD = 40.4673"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"grid-resolution","dir":"Articles","previous_headings":"Optimizing Parameters","what":"Grid Resolution","title":"Spatial Coverage Sampling Methods","text":"Control discretization resolution n_cells cell_size:","code":"# Coarse grid (fast) strata_coarse <- ss_stratify(   study_area,   n_strata = 25,   n_cells = 500,   n_try = 3 )  # Fine grid (slower but more precise) strata_fine <- ss_stratify(   study_area,   n_strata = 25,   n_cells = 5000,   n_try = 3 )  cat(\"Coarse grid:\", nrow(strata_coarse$cells), \"cells\\n\") #> Coarse grid: 512 cells cat(\"Fine grid:  \", nrow(strata_fine$cells), \"cells\\n\") #> Fine grid:   5000 cells"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"stratified-random-sampling","dir":"Articles","previous_headings":"","what":"Stratified Random Sampling","title":"Spatial Coverage Sampling Methods","text":"design-based inference, use stratified random sampling instead centroid placement:  provides: - Valid probability sampling - Unbiased estimates means totals - Better precision simple random sampling","code":"# Create strata strata <- ss_stratify(study_area, n_strata = 25, n_try = 5)  # Take 1 random sample per stratum samples_strat <- ss_stratified(strata, n_per_stratum = 1)  # Or take multiple samples per stratum samples_strat_3 <- ss_stratified(strata, n_per_stratum = 3)  ss_plot(strata, samples = samples_strat_3)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"composite-sampling","dir":"Articles","previous_headings":"","what":"Composite Sampling","title":"Spatial Coverage Sampling Methods","text":"laboratory cost reduction, combine samples multiple locations:","code":"# Create 3 composite samples from 20 equal-area strata samples_comp <- ss_composite(study_area, n_strata = 20, n_composites = 3)  # Each composite includes one sample from each stratum ss_plot(samples_comp)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"working-with-geographic-coordinates","dir":"Articles","previous_headings":"","what":"Working with Geographic Coordinates","title":"Spatial Coverage Sampling Methods","text":"package handles lat/lon coordinates automatically:","code":"# Study area with geographic CRS study_area_geo <- st_transform(study_area, crs = 4326)  # The algorithm uses haversine distance automatically samples_geo <- ss_coverage(study_area_geo, n_strata = 25, n_try = 5)  # Note: equal_area is not supported for lat/lon # This will produce an error: # samples_error <- ss_coverage_equal_area(study_area_geo, n_strata = 25)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"practical-workflow","dir":"Articles","previous_headings":"","what":"Practical Workflow","title":"Spatial Coverage Sampling Methods","text":"typical workflow soil survey:","code":"# 1. Load study area study_area <- st_read(\"my_field.shp\")  # 2. Design sampling scheme set.seed(42)  # For reproducibility samples <- ss_coverage(study_area, n_strata = 50, n_try = 10)  # 3. Examine results print(samples) summary(samples)  # 4. Export for field work coords <- ss_to_data_frame(samples) write.csv(coords, \"field_sampling_locations.csv\", row.names = FALSE)  # 5. Export as shapefile for GPS st_write(ss_to_sf(samples), \"sampling_points.gpkg\")"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"comparison-with-other-methods","dir":"Articles","previous_headings":"","what":"Comparison with Other Methods","title":"Spatial Coverage Sampling Methods","text":"","code":"set.seed(789)  # Spatial coverage samp_coverage <- ss_coverage(study_area, n_strata = 25, n_try = 5)  # Stratified random strata <- ss_stratify(study_area, n_strata = 25, n_try = 5) samp_stratified <- ss_stratified(strata, n_per_stratum = 1)  # Simple random samp_random <- ss_random(study_area, n = 25)  # Compare spatial distribution par(mfrow = c(1, 3))  plot(st_geometry(study_area), main = \"Coverage\") plot(st_geometry(samp_coverage$samples), add = TRUE, pch = 19, col = \"red\")  plot(st_geometry(study_area), main = \"Stratified Random\") plot(st_geometry(samp_stratified$samples), add = TRUE, pch = 19, col = \"blue\")  plot(st_geometry(study_area), main = \"Simple Random\") plot(st_geometry(samp_random$samples), add = TRUE, pch = 19, col = \"green\") par(mfrow = c(1, 1))"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/spatial-coverage.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Spatial Coverage Sampling Methods","text":"Walvoort, D.J.J., Brus, D.J., de Gruijter, J.J. (2010). R package spatial coverage sampling random sampling compact geographical strata k-means. Computers & Geosciences 36, 1261-1267. DOI: 10.1016/j.cageo.2010.04.005 de Gruijter, J.J., Brus, D.J., Bierkens, M.F.P., Knotters, M. (2006). Sampling Natural Resource Monitoring. Springer, Berlin. Brus, D.J. de Gruijter, J.J. (1997). Random sampling geostatistical modelling? Choosing design-based model-based sampling strategies soil. Geoderma 80(1-2), 1-44.","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Complete User Guide for soilsampling Package","text":"soilsampling package provides comprehensive tools designing soil sampling schemes R. guide demonstrates available functions practical code examples.","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"installation","dir":"Articles","previous_headings":"Introduction","what":"Installation","title":"Complete User Guide for soilsampling Package","text":"","code":"# Install from local source install.packages(\"soilsampling\", repos = NULL, type = \"source\")  # Or using devtools devtools::install_local(\"path/to/soilsampling\")"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"load-package","dir":"Articles","previous_headings":"Introduction","what":"Load Package","title":"Complete User Guide for soilsampling Package","text":"","code":"library(soilsampling) library(sf) #> Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.4.0; sf_use_s2() is TRUE  # Set seed for reproducibility set.seed(42)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"create-study-area","dir":"Articles","previous_headings":"Introduction","what":"Create Study Area","title":"Complete User Guide for soilsampling Package","text":"examples, â€™ll use simple rectangular study area:","code":"# Create a polygon poly <- st_polygon(list(rbind(   c(0, 0), c(100, 0), c(100, 50), c(0, 50), c(0, 0) )))  # Create sf object study_area <- st_sf(geometry = st_sfc(poly))"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_stratify---create-compact-strata","dir":"Articles","previous_headings":"1. Stratification Functions","what":"1.1 ss_stratify() - Create Compact Strata","title":"Complete User Guide for soilsampling Package","text":"Creates compact geographical strata using k-means clustering. Basic Usage: Equal-Area Strata: Prior Points: Advanced Parameters:","code":"# Create 25 compact strata strata <- ss_stratify(study_area, n_strata = 25, n_try = 5)  # View structure print(strata) #> Soil Sampling Stratification #> ============================ #> Number of strata: 25  #> Number of cells: 2485  #> Cell size: 1.41 x 1.41  #> MSSD: 42.0403  #> Converged: TRUE  #> Equal area: FALSE # Create 20 equal-area strata strata_equal <- ss_stratify(   study_area,   n_strata = 20,   equal_area = TRUE,   n_try = 5 ) # Existing sample locations prior_pts <- st_as_sf(   data.frame(x = c(25, 75), y = c(25, 25)),   coords = c(\"x\", \"y\") )  # Create stratification around prior points strata_prior <- ss_stratify(   study_area,   n_strata = 20,   prior_points = prior_pts,   n_try = 5 ) # Fine-tune stratification strata_custom <- ss_stratify(   study_area,   n_strata = 30,   n_cells = 2500,      # Higher resolution grid   n_try = 10,          # More attempts to find optimal   equal_area = FALSE,   verbose = TRUE ) #> 2025-12-24 04:00:36 | Optimizing configuration 1 #>     Current MSSD: 33.7103 #>     Best MSSD: 33.7103 #> 2025-12-24 04:00:36 | Optimizing configuration 2 #>     Current MSSD: 36.4875 #>     Best MSSD: 33.7103 #> 2025-12-24 04:00:36 | Optimizing configuration 3 #>     Current MSSD: 34.0026 #>     Best MSSD: 33.7103 #> 2025-12-24 04:00:36 | Optimizing configuration 4 #>     Current MSSD: 37.1821 #>     Best MSSD: 33.7103 #> 2025-12-24 04:00:36 | Optimizing configuration 5 #>     Current MSSD: 35.1059 #>     Best MSSD: 33.7103 #> 2025-12-24 04:00:36 | Optimizing configuration 6 #>     Current MSSD: 41.1071 #>     Best MSSD: 33.7103 #> 2025-12-24 04:00:36 | Optimizing configuration 7 #>     Current MSSD: 40.3993 #>     Best MSSD: 33.7103 #> 2025-12-24 04:00:36 | Optimizing configuration 8 #>     Current MSSD: 35.2979 #>     Best MSSD: 33.7103 #> 2025-12-24 04:00:36 | Optimizing configuration 9 #>     Current MSSD: 36.664 #>     Best MSSD: 33.7103 #> 2025-12-24 04:00:36 | Optimizing configuration 10 #>     Current MSSD: 42.7942 #>     Best MSSD: 33.7103"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_random---simple-random-sampling","dir":"Articles","previous_headings":"2. Sampling Functions","what":"2.1 ss_random() - Simple Random Sampling","title":"Complete User Guide for soilsampling Package","text":"Generates random sampling points uniformly distributed across study area. Basic Usage: Seed Reproducibility:","code":"# Select 30 random points samples_random <- ss_random(study_area, n = 30) print(samples_random) #> Simple Random Sampling  #> ======================  #> Number of samples: 30 # Reproducible random sampling samples_random_rep <- ss_random(study_area, n = 25, seed = 123)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_stratified---stratified-random-sampling","dir":"Articles","previous_headings":"2. Sampling Functions","what":"2.2 ss_stratified() - Stratified Random Sampling","title":"Complete User Guide for soilsampling Package","text":"Random sampling within stratum. Basic Usage: Multiple Points per Stratum: Different Seed:","code":"# Create strata first strata <- ss_stratify(study_area, n_strata = 25, n_try = 5)  # Sample 1 point per stratum samples_strat <- ss_stratified(strata, n_per_stratum = 1) print(samples_strat) #> Stratified Random Sampling  #> ==========================  #> Number of samples: 25  #> Number of strata: 25  #> Samples per stratum: 1 # Sample 2 points per stratum samples_strat2 <- ss_stratified(strata, n_per_stratum = 2, seed = 456) # Different random realization samples_strat3 <- ss_stratified(strata, n_per_stratum = 1, seed = 789)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_coverage---spatial-coverage-sampling","dir":"Articles","previous_headings":"2. Sampling Functions","what":"2.3 ss_coverage() - Spatial Coverage Sampling","title":"Complete User Guide for soilsampling Package","text":"Purposive sampling stratum centroids optimal spatial coverage. Strata Object: Direct Approach: Prior Points:","code":"# Use pre-computed strata strata <- ss_stratify(study_area, n_strata = 25, n_try = 5) samples_cov <- ss_coverage(strata) print(samples_cov) #> Spatial Coverage Sampling  #> =========================  #> Number of samples: 25  #> Number of strata: 25 # All-in-one: stratify and sample samples_cov_direct <- ss_coverage(   study_area,   n_strata = 20,   n_try = 5 ) # Prior points marked differently prior_pts <- st_as_sf(   data.frame(x = c(50), y = c(25)),   coords = c(\"x\", \"y\") )  strata_prior <- ss_stratify(   study_area,   n_strata = 24,   prior_points = prior_pts,   n_try = 5 )  samples_prior <- ss_coverage(strata_prior)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_coverage_equal_area---equal-area-coverage-sampling","dir":"Articles","previous_headings":"2. Sampling Functions","what":"2.4 ss_coverage_equal_area() - Equal-Area Coverage Sampling","title":"Complete User Guide for soilsampling Package","text":"Coverage sampling strata equal size. Basic Usage: Custom Parameters:","code":"# Create 25 equal-area strata and sample samples_eq <- ss_coverage_equal_area(   study_area,   n_strata = 25,   n_try = 5 ) print(samples_eq) #> Spatial Coverage Sampling (Equal Area)  #> ======================================  #> Number of samples: 25  #> Number of strata: 25 # Fine-tuned equal-area sampling samples_eq_custom <- ss_coverage_equal_area(   study_area,   n_strata = 30,   n_cells = 3000,   n_try = 10 )"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_maxvol---maxvol-optimal-design-sampling","dir":"Articles","previous_headings":"2. Sampling Functions","what":"2.5 ss_maxvol() - Maxvol Optimal Design Sampling","title":"Complete User Guide for soilsampling Package","text":"Feature-based sampling using D-optimal experimental design. sf Object Features: Feature Matrix: Minimum Distance Constraint: Advanced Options:","code":"# Create grid with features strata <- ss_stratify(study_area, n_strata = 100, n_try = 3) cells_sf <- strata$cells  # Add terrain-like features coords <- st_coordinates(cells_sf) cells_sf$elevation <- coords[,2] + rnorm(nrow(coords), 0, 5) cells_sf$slope <- abs(rnorm(nrow(coords), 5, 2)) cells_sf$twi <- rnorm(nrow(coords), 8, 1.5)  # Select optimal samples based on features samples_maxvol <- ss_maxvol(   cells_sf,   n = 20,   features = c(\"elevation\", \"slope\", \"twi\"),   normalize = TRUE,   add_coords = TRUE ) print(samples_maxvol) #> NA  #> NA  #> Number of samples: 20 # Custom feature matrix n_loc <- 100 feature_mat <- matrix(   c(     rnorm(n_loc, 100, 10),   # elevation     abs(rnorm(n_loc, 5, 2)),  # slope     rnorm(n_loc, 8, 1.5)      # TWI   ),   ncol = 3 ) colnames(feature_mat) <- c(\"elevation\", \"slope\", \"twi\")  coords_mat <- cbind(   x = runif(n_loc, 0, 100),   y = runif(n_loc, 0, 50) )  samples_maxvol_mat <- ss_maxvol(   feature_mat,   n = 15,   coords = coords_mat,   normalize = TRUE,   seed = 789 ) # Prevent spatial clustering samples_maxvol_dist <- ss_maxvol(   cells_sf,   n = 15,   features = c(\"elevation\", \"slope\", \"twi\"),   min_dist = 8,        # Minimum 8 units between samples   normalize = TRUE,   add_coords = TRUE ) # Fine-tune maxvol algorithm samples_maxvol_adv <- ss_maxvol(   cells_sf,   n = 25,   features = c(\"elevation\", \"slope\"),   min_dist = 5,   normalize = TRUE,   add_coords = FALSE,   # Don't include coordinates   tol = 1.2,            # Convergence tolerance   max_iters = 200,      # Maximum iterations   verbose = TRUE,   seed = 999 ) #> Normalized features #> Running maxvol algorithm... #> Maxvol converged in 1 iterations"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_composite---composite-sampling","dir":"Articles","previous_headings":"2. Sampling Functions","what":"2.6 ss_composite() - Composite Sampling","title":"Complete User Guide for soilsampling Package","text":"Sampling combining samples multiple locations. Basic Usage: Composites:","code":"# Create 3 composite samples from 20 strata samples_comp <- ss_composite(   study_area,   n_strata = 20,   n_composites = 3 ) print(samples_comp) #> Composite Sampling  #> ==================  #> Number of samples: 60  #> Number of strata: 20  #> Number of composites: 3  #> Samples per stratum: 3 # Create 5 composite samples samples_comp5 <- ss_composite(   study_area,   n_strata = 30,   n_composites = 5,   n_try = 10 )"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_plot---plot-strata-andor-samples","dir":"Articles","previous_headings":"3. Visualization Functions","what":"3.1 ss_plot() - Plot Strata and/or Samples","title":"Complete User Guide for soilsampling Package","text":"Main plotting function stratification samples. Plot Strata :  Plot Strata Samples:  Plot Prior Points:","code":"strata <- ss_stratify(study_area, n_strata = 25, n_try = 5) ss_plot(strata) samples <- ss_stratified(strata, n_per_stratum = 1) ss_plot(strata, samples = samples) prior_pts <- st_as_sf(   data.frame(x = c(25, 75), y = c(25, 25)),   coords = c(\"x\", \"y\") )  strata_prior <- ss_stratify(   study_area,   n_strata = 23,   prior_points = prior_pts,   n_try = 5 )  samples_prior <- ss_coverage(strata_prior) ss_plot(strata_prior, samples = samples_prior)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_plot_samples---plot-samples-only","dir":"Articles","previous_headings":"3. Visualization Functions","what":"3.2 ss_plot_samples() - Plot Samples Only","title":"Complete User Guide for soilsampling Package","text":"Plot sampling points without stratification. Basic Usage:  Composite Samples:","code":"samples <- ss_random(study_area, n = 30) ss_plot_samples(samples) samples_comp <- ss_composite(study_area, n_strata = 20, n_composites = 3) ss_plot_samples(samples_comp)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"plot---s3-plot-methods","dir":"Articles","previous_headings":"3. Visualization Functions","what":"3.3 plot() - S3 Plot Methods","title":"Complete User Guide for soilsampling Package","text":"Generic plot methods ss_strata ss_samples objects. Plot Strata:  Plot Samples:","code":"strata <- ss_stratify(study_area, n_strata = 20, n_try = 5) plot(strata) samples <- ss_coverage(study_area, n_strata = 25, n_try = 5) plot(samples)"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_summary---get-summary-statistics","dir":"Articles","previous_headings":"4. Summary and Information Functions","what":"4.1 ss_summary() - Get Summary Statistics","title":"Complete User Guide for soilsampling Package","text":"Comprehensive summary stratification sampling results. Strata: Samples:","code":"strata <- ss_stratify(study_area, n_strata = 25, n_try = 5) summary(strata) #> Soil Sampling Stratification Summary #> ===================================== #>  #> Strata: #>   Number of strata: 25  #>   Total cells: 2485  #>   Cells per stratum (mean): 99.4  #>   Cells per stratum (range): 31 - 193  #>  #> Algorithm: #>   Equal area: FALSE  #>   Converged: TRUE  #>   MSSD: 39.6099  #>  #> Area: #>   Cell size: 1.41 x 1.41  #>   Total area: 4970 samples <- ss_coverage(strata) summary_samples <- ss_summary(samples) print(summary_samples) #>     method n_samples    x_min    x_max    y_min    y_max n_strata     mssd #> 1 coverage        25 3.760522 95.12796 3.307435 46.57349       25 39.60994 #>   equal_area #> 1      FALSE"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_summary-maxvol---maxvol-summary","dir":"Articles","previous_headings":"4. Summary and Information Functions","what":"4.2 ss_summary.maxvol() - Maxvol Summary","title":"Complete User Guide for soilsampling Package","text":"Special summary maxvol sampling results.","code":"# Create grid with features strata <- ss_stratify(study_area, n_strata = 100, n_try = 3) cells_sf <- strata$cells coords <- st_coordinates(cells_sf) cells_sf$elevation <- coords[,2] + rnorm(nrow(coords), 0, 5) cells_sf$slope <- abs(rnorm(nrow(coords), 5, 2))  samples_maxvol <- ss_maxvol(   cells_sf,   n = 20,   features = c(\"elevation\", \"slope\"),   normalize = TRUE )  # Get maxvol-specific summary summary_maxvol <- ss_summary.maxvol(samples_maxvol) #> Maxvol Optimal Design Sampling - Summary #> ========================================= #>  #> Samples: #>   Total samples: 20  #>   X range: 0.71 - 26.16  #>   Y range: 0.71 - 44.55  #>  #> Maxvol Algorithm: #>   Features used: 4  #>   Feature names: elevation, slope, X, Y  #>   Converged: TRUE  #>   Iterations: 2 print(summary_maxvol) #> NA  #> NA  #> Number of samples: 20"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"print---print-objects","dir":"Articles","previous_headings":"4. Summary and Information Functions","what":"4.3 print() - Print Objects","title":"Complete User Guide for soilsampling Package","text":"Print Strata: Print Samples:","code":"strata <- ss_stratify(study_area, n_strata = 20, n_try = 5) print(strata) #> Soil Sampling Stratification #> ============================ #> Number of strata: 20  #> Number of cells: 2485  #> Cell size: 1.41 x 1.41  #> MSSD: 52.6047  #> Converged: TRUE  #> Equal area: FALSE samples <- ss_random(study_area, n = 25) print(samples) #> Simple Random Sampling  #> ======================  #> Number of samples: 25"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"summary---generic-summary","dir":"Articles","previous_headings":"4. Summary and Information Functions","what":"4.4 summary() - Generic Summary","title":"Complete User Guide for soilsampling Package","text":"Summary Strata: Summary Samples:","code":"strata <- ss_stratify(study_area, n_strata = 25, n_try = 5) summary(strata) #> Soil Sampling Stratification Summary #> ===================================== #>  #> Strata: #>   Number of strata: 25  #>   Total cells: 2485  #>   Cells per stratum (mean): 99.4  #>   Cells per stratum (range): 27 - 170  #>  #> Algorithm: #>   Equal area: FALSE  #>   Converged: TRUE  #>   MSSD: 40.4696  #>  #> Area: #>   Cell size: 1.41 x 1.41  #>   Total area: 4970 samples <- ss_coverage(strata) summary(samples) #> Spatial Coverage Sampling  - Summary #> ===================================  #>  #> Samples: #>   Total samples: 25  #>   X range: 4.12 - 95.53  #>   Y range: 4.14 - 44.85  #>  #> Stratification: #>   Number of strata: 25  #>   Equal area: FALSE  #>   MSSD: 40.4696"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_n_strata---get-number-of-strata","dir":"Articles","previous_headings":"5. Utility Functions","what":"5.1 ss_n_strata() - Get Number of Strata","title":"Complete User Guide for soilsampling Package","text":"","code":"strata <- ss_stratify(study_area, n_strata = 25, n_try = 5) n_strata <- ss_n_strata(strata) print(n_strata) #> [1] 25"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_n_samples---get-number-of-samples","dir":"Articles","previous_headings":"5. Utility Functions","what":"5.2 ss_n_samples() - Get Number of Samples","title":"Complete User Guide for soilsampling Package","text":"","code":"samples <- ss_random(study_area, n = 30) n_samples <- ss_n_samples(samples) print(n_samples) #> [1] 30"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_get_samples---extract-samples-as-sf-object","dir":"Articles","previous_headings":"5. Utility Functions","what":"5.3 ss_get_samples() - Extract Samples as sf Object","title":"Complete User Guide for soilsampling Package","text":"","code":"samples <- ss_coverage(study_area, n_strata = 20, n_try = 5) samples_sf <- ss_get_samples(samples) head(samples_sf) #> Simple feature collection with 6 features and 3 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 11.13327 ymin: 8.278927 xmax: 51.83682 ymax: 41.51285 #> CRS:           NA #>   sample_id stratum_id is_prior                  geometry #> 1         1          1    FALSE POINT (37.16239 24.66074) #> 2         2          2    FALSE  POINT (45.3529 41.51285) #> 3         3          3    FALSE POINT (51.83682 11.90296) #> 4         4          4    FALSE POINT (22.81176 8.278927) #> 5         5          5    FALSE  POINT (11.13327 16.8584) #> 6         6          6    FALSE POINT (11.90231 37.75318)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_to_sf---convert-to-sf-object","dir":"Articles","previous_headings":"5. Utility Functions","what":"5.4 ss_to_sf() - Convert to sf Object","title":"Complete User Guide for soilsampling Package","text":"","code":"samples <- ss_random(study_area, n = 25) samples_sf <- ss_to_sf(samples) class(samples_sf) #> [1] \"sf\"         \"data.frame\" head(samples_sf) #> Simple feature collection with 6 features and 1 field #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 11.2348 ymin: 0.2503823 xmax: 54.97829 ymax: 35.30538 #> CRS:           NA #>   sample_id                   geometry #> 1         1 POINT (43.70442 0.2503823) #> 2         2  POINT (54.97829 30.98729) #> 3         3   POINT (11.2348 35.30538) #> 4         4  POINT (16.84822 25.71406) #> 5         5  POINT (35.64097 5.585776) #> 6         6   POINT (19.2194 19.65943)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_to_data_frame---convert-to-data-frame","dir":"Articles","previous_headings":"5. Utility Functions","what":"5.5 ss_to_data_frame() - Convert to Data Frame","title":"Complete User Guide for soilsampling Package","text":"Extract coordinates attributes data frame.","code":"samples <- ss_coverage(study_area, n_strata = 20, n_try = 5) coords_df <- ss_to_data_frame(samples) head(coords_df) #>   sample_id stratum_id is_prior        X        Y #> 1         1          1    FALSE 84.23966 34.35649 #> 2         2          2    FALSE 13.51237 36.95738 #> 3         3          3    FALSE 10.85043 12.83033 #> 4         4          4    FALSE 27.93978 16.87991 #> 5         5          5    FALSE 93.03009 10.02530 #> 6         6          6    FALSE 30.85343 43.62849"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_area---get-stratum-areas","dir":"Articles","previous_headings":"5. Utility Functions","what":"5.6 ss_area() - Get Stratum Areas","title":"Complete User Guide for soilsampling Package","text":"","code":"strata <- ss_stratify(study_area, n_strata = 25, n_try = 5) areas <- ss_area(strata) head(areas) #>   1   2   3   4   5   6  #> 348 266 194 182 270  98"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"ss_relative_area---get-relative-stratum-areas","dir":"Articles","previous_headings":"5. Utility Functions","what":"5.7 ss_relative_area() - Get Relative Stratum Areas","title":"Complete User Guide for soilsampling Package","text":"","code":"strata <- ss_stratify(study_area, n_strata = 25, n_try = 5) rel_areas <- ss_relative_area(strata) head(rel_areas) #>          1          2          3          4          5          6  #> 0.02535211 0.03259557 0.03460765 0.04507042 0.03098592 0.03420523 sum(rel_areas)  # Should sum to 1 #> [1] 1"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"workflow-1-simple-random-sampling","dir":"Articles","previous_headings":"6. Complete Workflows","what":"6.1 Workflow 1: Simple Random Sampling","title":"Complete User Guide for soilsampling Package","text":"","code":"# 1. Create study area study_area <- st_sf(geometry = st_sfc(   st_polygon(list(rbind(     c(0, 0), c(100, 0), c(100, 50), c(0, 50), c(0, 0)   ))) ))  # 2. Generate random samples set.seed(42) samples <- ss_random(study_area, n = 30)  # 3. Visualize ss_plot_samples(samples) # 4. Export coordinates coords <- ss_to_data_frame(samples) head(coords) #>   sample_id        X          Y #> 1         1 91.48060 36.8797809 #> 2         2 93.70754 40.5527571 #> 3         3 28.61395 19.4054141 #> 4         4 83.04476 34.2584865 #> 5         5 64.17455  0.1974169 #> 6         6 51.90959 41.6458040  # 5. Get summary summary(samples) #> Simple Random Sampling  - Summary #> ================================  #>  #> Samples: #>   Total samples: 30  #>   X range: 8.24 - 98.89  #>   Y range: 0.2 - 48.68"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"workflow-2-stratified-sampling","dir":"Articles","previous_headings":"6. Complete Workflows","what":"6.2 Workflow 2: Stratified Sampling","title":"Complete User Guide for soilsampling Package","text":"","code":"# 1. Create compact strata set.seed(123) strata <- ss_stratify(study_area, n_strata = 25, n_try = 5)  # 2. Sample within strata samples <- ss_stratified(strata, n_per_stratum = 1)  # 3. Visualize ss_plot(strata, samples = samples) # 4. Get information print(paste(\"Number of strata:\", ss_n_strata(strata))) #> [1] \"Number of strata: 25\" print(paste(\"Number of samples:\", ss_n_samples(samples))) #> [1] \"Number of samples: 25\"  # 5. Check stratum areas areas <- ss_area(strata) print(paste(\"Area range:\", round(min(areas), 2), \"-\", round(max(areas), 2))) #> [1] \"Area range: 54 - 386\""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"workflow-3-spatial-coverage-sampling","dir":"Articles","previous_headings":"6. Complete Workflows","what":"6.3 Workflow 3: Spatial Coverage Sampling","title":"Complete User Guide for soilsampling Package","text":"","code":"# 1. All-in-one approach set.seed(456) samples <- ss_coverage(study_area, n_strata = 30, n_try = 10)  # 2. Visualize plot(samples) # 3. Get summary statistics summary_info <- ss_summary(samples) print(summary_info) #>     method n_samples    x_min    x_max    y_min   y_max n_strata     mssd #> 1 coverage        30 2.016564 91.92388 2.606194 43.6992       30 35.63954 #>   equal_area #> 1      FALSE  # 4. Export as sf object samples_sf <- ss_to_sf(samples)  # Write to file (example) # st_write(samples_sf, \"samples.gpkg\")"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"workflow-4-maxvol-optimal-design","dir":"Articles","previous_headings":"6. Complete Workflows","what":"6.4 Workflow 4: Maxvol Optimal Design","title":"Complete User Guide for soilsampling Package","text":"","code":"# 1. Create grid with features strata <- ss_stratify(study_area, n_strata = 100, n_try = 5) cells <- strata$cells  # 2. Add terrain features coords <- st_coordinates(cells) cells$elevation <- coords[,2] + rnorm(nrow(coords), 0, 5) cells$slope <- abs(rnorm(nrow(coords), 5, 2)) cells$aspect <- runif(nrow(coords), 0, 360) cells$twi <- rnorm(nrow(coords), 8, 1.5)  # 3. Select optimal samples set.seed(789) samples <- ss_maxvol(   cells,   n = 25,   features = c(\"elevation\", \"slope\", \"aspect\", \"twi\"),   min_dist = 5,   normalize = TRUE,   add_coords = TRUE,   verbose = TRUE ) #> Added coordinates as features #> Normalized features #> Running maxvol algorithm... #> Maxvol converged in 1 iterations  # 4. Check convergence print(paste(\"Converged:\", samples$converged)) #> [1] \"Converged: TRUE\" print(paste(\"Iterations:\", samples$iterations)) #> [1] \"Iterations: 1\"  # 5. Visualize ss_plot_samples(samples) # 6. Get maxvol summary summary_maxvol <- ss_summary.maxvol(samples) #> Maxvol Optimal Design Sampling - Summary #> ========================================= #>  #> Samples: #>   Total samples: 25  #>   X range: 2.12 - 96.87  #>   Y range: 0.71 - 48.79  #>  #> Maxvol Algorithm: #>   Features used: 6  #>   Feature names: elevation, slope, aspect, twi, X, Y  #>   Converged: TRUE  #>   Iterations: 1 print(summary_maxvol) #> NA  #> NA  #> Number of samples: 25"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"workflow-5-composite-sampling","dir":"Articles","previous_headings":"6. Complete Workflows","what":"6.5 Workflow 5: Composite Sampling","title":"Complete User Guide for soilsampling Package","text":"","code":"# 1. Create composite samples set.seed(111) samples <- ss_composite(   study_area,   n_strata = 30,   n_composites = 4,   n_try = 10 )  # 2. Visualize (different symbols per composite) ss_plot_samples(samples) # 3. Get composite assignments samples_sf <- ss_to_sf(samples) table(samples_sf$composite_id) #> < table of extent 0 >  # 4. Export by composite coords <- ss_to_data_frame(samples) head(coords) #>   stratum_id sample_id composite        X        Y #> 1          1         1         1 40.45178 42.36465 #> 2          1         2         2 46.41346 38.69992 #> 3          1         3         3 44.22392 47.31324 #> 4          1         4         4 45.01655 36.99218 #> 5          2         5         1 42.49344 18.87764 #> 6          2         6         2 39.99177 14.58974"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"workflow-6-working-with-prior-points","dir":"Articles","previous_headings":"6. Complete Workflows","what":"6.6 Workflow 6: Working with Prior Points","title":"Complete User Guide for soilsampling Package","text":"","code":"# 1. Define existing sample locations prior_points <- st_as_sf(   data.frame(x = c(20, 80), y = c(15, 35)),   coords = c(\"x\", \"y\") )  # 2. Create stratification around prior points strata <- ss_stratify(   study_area,   n_strata = 23,  # Total will be 25 with 2 prior points   prior_points = prior_points,   n_try = 5 )  # 3. Sample at centroids samples <- ss_coverage(strata)  # 4. Visualize (prior points shown differently) ss_plot(strata, samples = samples) # 5. Check which are prior points samples_sf <- ss_to_sf(samples) table(samples_sf$is_prior) #>  #> FALSE  TRUE  #>    21     2"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"export-to-csv","dir":"Articles","previous_headings":"7. Exporting Results","what":"7.1 Export to CSV","title":"Complete User Guide for soilsampling Package","text":"","code":"# Get coordinates as data frame samples <- ss_coverage(study_area, n_strata = 25, n_try = 5) coords <- ss_to_data_frame(samples)  # Write to CSV write.csv(coords, \"sampling_points.csv\", row.names = FALSE)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"export-to-shapefile","dir":"Articles","previous_headings":"7. Exporting Results","what":"7.2 Export to Shapefile","title":"Complete User Guide for soilsampling Package","text":"","code":"# Convert to sf object samples_sf <- ss_to_sf(samples)  # Write shapefile st_write(samples_sf, \"sampling_points.shp\")"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"export-to-geopackage","dir":"Articles","previous_headings":"7. Exporting Results","what":"7.3 Export to GeoPackage","title":"Complete User Guide for soilsampling Package","text":"","code":"# Write GeoPackage st_write(samples_sf, \"sampling_points.gpkg\")"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"export-to-geojson","dir":"Articles","previous_headings":"7. Exporting Results","what":"7.4 Export to GeoJSON","title":"Complete User Guide for soilsampling Package","text":"","code":"# Write GeoJSON st_write(samples_sf, \"sampling_points.geojson\")"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"visual-comparison","dir":"Articles","previous_headings":"8. Comparison of Methods","what":"8.1 Visual Comparison","title":"Complete User Guide for soilsampling Package","text":"","code":"# Set seed for consistency set.seed(999)  # Random sampling samples_random <- ss_random(study_area, n = 20)  # Stratified sampling strata <- ss_stratify(study_area, n_strata = 20, n_try = 5) samples_strat <- ss_stratified(strata, n_per_stratum = 1)  # Coverage sampling samples_cov <- ss_coverage(study_area, n_strata = 20, n_try = 5)  # Composite sampling samples_comp <- ss_composite(study_area, n_strata = 20, n_composites = 4)  # Note: Plotting would show the differences # In practice, use plot() or ss_plot_samples() for each"},{"path":[]},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"choosing-number-of-strata","dir":"Articles","previous_headings":"9. Tips and Best Practices","what":"9.1 Choosing Number of Strata","title":"Complete User Guide for soilsampling Package","text":"","code":"# Rule of thumb: n_strata â‰ˆ sqrt(study area / typical mapping unit) # For our 5000 unitÂ² area with ~100 unitÂ² mapping units: n_strata_suggested <- round(sqrt(5000 / 100)) print(paste(\"Suggested strata:\", n_strata_suggested)) #> [1] \"Suggested strata: 7\""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"using-multiple-tries","dir":"Articles","previous_headings":"9. Tips and Best Practices","what":"9.2 Using Multiple Tries","title":"Complete User Guide for soilsampling Package","text":"","code":"# Always use n_try > 1 to avoid local optima strata_few <- ss_stratify(study_area, n_strata = 25, n_try = 1) strata_many <- ss_stratify(study_area, n_strata = 25, n_try = 10)  # Compare MSSD (lower is better) print(paste(\"Few tries MSSD:\", round(strata_few$mssd, 2))) #> [1] \"Few tries MSSD: 43.68\" print(paste(\"Many tries MSSD:\", round(strata_many$mssd, 2))) #> [1] \"Many tries MSSD: 40.29\""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"checking-convergence","dir":"Articles","previous_headings":"9. Tips and Best Practices","what":"9.3 Checking Convergence","title":"Complete User Guide for soilsampling Package","text":"","code":"strata <- ss_stratify(study_area, n_strata = 25, n_try = 5)  # Check if algorithm converged print(paste(\"Converged:\", strata$converged)) #> [1] \"Converged: TRUE\" print(paste(\"Iterations:\", strata$iterations)) #> [1] \"Iterations: \" print(paste(\"MSSD:\", round(strata$mssd, 2))) #> [1] \"MSSD: 41.06\""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"reproducibility","dir":"Articles","previous_headings":"9. Tips and Best Practices","what":"9.4 Reproducibility","title":"Complete User Guide for soilsampling Package","text":"","code":"# Always set seed for reproducible results set.seed(42) samples1 <- ss_random(study_area, n = 20)  set.seed(42) samples2 <- ss_random(study_area, n = 20)  # Should be identical coords1 <- st_coordinates(ss_to_sf(samples1)) coords2 <- st_coordinates(ss_to_sf(samples2)) identical(coords1, coords2) #> [1] TRUE"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"study-area-issues","dir":"Articles","previous_headings":"10. Troubleshooting","what":"10.1 Study Area Issues","title":"Complete User Guide for soilsampling Package","text":"","code":"# Empty geometry will fail empty_poly <- st_polygon(list(matrix(numeric(0), ncol = 2))) #> Error in `y[1, ]`: #> ! subscript out of bounds # ss_stratify(st_sf(geometry = st_sfc(empty_poly)), n_strata = 10)"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"too-many-strata","dir":"Articles","previous_headings":"10. Troubleshooting","what":"10.2 Too Many Strata","title":"Complete User Guide for soilsampling Package","text":"","code":"# Too many strata for small area # ss_stratify(study_area, n_strata = 10000, n_try = 5) # Will warn about grid resolution"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"maxvol-requirements","dir":"Articles","previous_headings":"10. Troubleshooting","what":"10.3 Maxvol Requirements","title":"Complete User Guide for soilsampling Package","text":"","code":"# n must be >= number of features feature_mat <- matrix(rnorm(500), ncol = 5) coords_mat <- cbind(x = 1:100, y = 1:100)  # This will fail: n < n_features # ss_maxvol(feature_mat, n = 3, coords = coords_mat)  # This will work: n >= n_features samples <- ss_maxvol(feature_mat, n = 10, coords = coords_mat) #> Warning: Initial submatrix is rank deficient, attempting to improve selection #> Error: #> ! Cannot find linearly independent initial submatrix. Features may be too correlated or insufficient."},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"custom-grid-resolution","dir":"Articles","previous_headings":"11. Advanced Topics","what":"11.1 Custom Grid Resolution","title":"Complete User Guide for soilsampling Package","text":"","code":"# Higher resolution for detailed areas strata_fine <- ss_stratify(   study_area,   n_strata = 25,   n_cells = 5000,  # Default is ~2500   n_try = 5 )  # Lower resolution for large areas strata_coarse <- ss_stratify(   study_area,   n_strata = 25,   n_cells = 1000,   n_try = 5 )"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"working-with-real-shapefiles","dir":"Articles","previous_headings":"11. Advanced Topics","what":"11.2 Working with Real Shapefiles","title":"Complete User Guide for soilsampling Package","text":"","code":"# Read shapefile study_area <- st_read(\"path/to/study_area.shp\")  # Create sampling design set.seed(42) samples <- ss_coverage(study_area, n_strata = 50, n_try = 10)  # Export results coords <- ss_to_data_frame(samples) write.csv(coords, \"sampling_points.csv\", row.names = FALSE)  # Or export as spatial file samples_sf <- ss_to_sf(samples) st_write(samples_sf, \"sampling_points.gpkg\")"},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"integrating-with-other-packages","dir":"Articles","previous_headings":"11. Advanced Topics","what":"11.3 Integrating with Other Packages","title":"Complete User Guide for soilsampling Package","text":"","code":"# Use with terra for raster data library(terra) dem <- rast(\"dem.tif\")  # Extract features at grid points # ... (feature extraction code)  # Use maxvol for optimal sampling samples <- ss_maxvol(   feature_matrix,   n = 50,   coords = coordinates_matrix,   normalize = TRUE )"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"stratification","dir":"Articles","previous_headings":"12. Function Reference Summary","what":"Stratification","title":"Complete User Guide for soilsampling Package","text":"ss_stratify() - Create compact geographical strata","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"sampling","dir":"Articles","previous_headings":"12. Function Reference Summary","what":"Sampling","title":"Complete User Guide for soilsampling Package","text":"ss_random() - Simple random sampling ss_stratified() - Stratified random sampling ss_coverage() - Spatial coverage sampling ss_coverage_equal_area() - Equal-area coverage sampling ss_maxvol() - Maxvol optimal design sampling ss_composite() - Composite sampling","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"visualization","dir":"Articles","previous_headings":"12. Function Reference Summary","what":"Visualization","title":"Complete User Guide for soilsampling Package","text":"ss_plot() - Plot strata /samples ss_plot_samples() - Plot samples plot.ss_strata() - S3 plot method strata plot.ss_samples() - S3 plot method samples","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"information","dir":"Articles","previous_headings":"12. Function Reference Summary","what":"Information","title":"Complete User Guide for soilsampling Package","text":"ss_summary() - Get summary statistics ss_summary.maxvol() - Maxvol-specific summary print.ss_strata() - Print strata print.ss_samples() - Print samples summary.ss_strata() - Summary strata summary.ss_samples() - Summary samples","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"utilities","dir":"Articles","previous_headings":"12. Function Reference Summary","what":"Utilities","title":"Complete User Guide for soilsampling Package","text":"ss_n_strata() - Get number strata ss_n_samples() - Get number samples ss_get_samples() - Extract samples sf ss_to_sf() - Convert sf object ss_to_data_frame() - Convert data frame ss_area() - Get stratum areas ss_relative_area() - Get relative stratum areas","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/articles/user-guide.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Complete User Guide for soilsampling Package","text":"de Gruijter, J.J., Brus, D.J., Bierkens, M.F.P., Knotters, M. (2006). Sampling Natural Resource Monitoring. Springer, Berlin. Walvoort, D.J.J., Brus, D.J., de Gruijter, J.J. (2010). R package spatial coverage sampling random sampling compact geographical strata k-means. Computers & Geosciences 36, 1261-1267. Petrovskaia, N., Korveh, K., Maas, E. (2021). Optimal soil sampling design based maxvol algorithm. Geoderma 381, 114733.","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Carlos Carbajal. Author, maintainer.","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Carbajal C (2025). soilsampling: Soil Sampling Design Methods Including Spatial Coverage, Simple Random, Stratified Sampling Maxvol Optimal Design Sampling. R package version 0.1.0, https://ccarbajal16.github.io/soilsampling/.","code":"@Manual{,   title = {soilsampling: Soil Sampling Design Methods Including Spatial Coverage, Simple Random, Stratified Sampling and Maxvol Optimal Design Sampling},   author = {Carlos Carbajal},   year = {2025},   note = {R package version 0.1.0},   url = {https://ccarbajal16.github.io/soilsampling/}, }"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"soilsampling-","dir":"","previous_headings":"","what":"soilsampling: Soil Sampling Design Methods","title":"soilsampling: Soil Sampling Design Methods","text":"Soil Sampling Design Methods Including Spatial Coverage, Maxvol Optimal Design, Simple Random, Stratified Sampling","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"soilsampling: Soil Sampling Design Methods","text":"soilsampling package provides methods designing soil sampling schemes. implements: Simple Random Sampling: Uniform random selection sampling locations Stratified Random Sampling: Random sampling within compact geographical strata Spatial Coverage Sampling: Purposive sampling stratum centroids optimal coverage Maxvol Optimal Design Sampling: Feature-based sampling using D-optimal experimental design Composite Sampling: Sampling equal-area strata combined samples Validation Metrics: Assess stratification quality coverage efficiency distance statistics","code":""},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"install-from-github-recommended","dir":"","previous_headings":"Installation","what":"Install from GitHub (Recommended)","title":"soilsampling: Soil Sampling Design Methods","text":"","code":"# Using pak (fastest) pak::pak(\"ccarbajal16/soilsampling\")  # Or using devtools devtools::install_github(\"ccarbajal16/soilsampling\")"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"install-from-local-source","dir":"","previous_headings":"Installation","what":"Install from Local Source","title":"soilsampling: Soil Sampling Design Methods","text":"","code":"# Install from local directory install.packages(\".\", repos = NULL, type = \"source\")  # Or using devtools devtools::install_local(\"path/to/soilsampling\")"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"dependencies","dir":"","previous_headings":"Installation","what":"Dependencies","title":"soilsampling: Soil Sampling Design Methods","text":"R (>= 4.1.0) sf (>= 1.0-12) ggplot2 (>= 3.3.0)","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"soilsampling: Soil Sampling Design Methods","text":"","code":"library(soilsampling) library(sf)  # Create a study area poly <- st_polygon(list(rbind(   c(0, 0), c(100, 0), c(100, 50), c(0, 50), c(0, 0) ))) study_area <- st_sf(geometry = st_sfc(poly))  # Set seed for reproducibility set.seed(42)  # Spatial coverage sampling samples <- ss_coverage(study_area, n_strata = 25, n_try = 5) ss_plot(samples)  # Get coordinates coords <- ss_to_data_frame(samples) head(coords)"},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"simple-random-sampling","dir":"","previous_headings":"Sampling Methods","what":"Simple Random Sampling","title":"soilsampling: Soil Sampling Design Methods","text":"Select locations uniformly random:","code":"samples <- ss_random(study_area, n = 30) ss_plot_samples(samples)"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"stratified-random-sampling","dir":"","previous_headings":"Sampling Methods","what":"Stratified Random Sampling","title":"soilsampling: Soil Sampling Design Methods","text":"Create strata first, sample randomly within :","code":"# Create 25 compact strata strata <- ss_stratify(study_area, n_strata = 25, n_try = 5)  # Take 1 random sample per stratum samples <- ss_stratified(strata, n_per_stratum = 1) ss_plot(strata, samples = samples)"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"spatial-coverage-sampling","dir":"","previous_headings":"Sampling Methods","what":"Spatial Coverage Sampling","title":"soilsampling: Soil Sampling Design Methods","text":"Place samples stratum centroids optimal spatial coverage:","code":"# Direct approach samples <- ss_coverage(study_area, n_strata = 25, n_try = 5)  # Or use pre-computed strata strata <- ss_stratify(study_area, n_strata = 25, n_try = 5) samples <- ss_coverage(strata)  ss_plot(samples)"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"spatial-coverage-with-prior-points","dir":"","previous_headings":"Sampling Methods","what":"Spatial Coverage with Prior Points","title":"soilsampling: Soil Sampling Design Methods","text":"Incorporate existing sampling locations:","code":"# Existing sample locations prior_pts <- st_as_sf(   data.frame(x = c(25, 75), y = c(25, 25)),   coords = c(\"x\", \"y\") )  # Create stratification around prior points strata <- ss_stratify(   study_area,    n_strata = 20,    prior_points = prior_pts,   n_try = 5 )  samples <- ss_coverage(strata) ss_plot(samples)  # Prior points shown with different symbol"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"equal-area-stratification","dir":"","previous_headings":"Sampling Methods","what":"Equal-Area Stratification","title":"soilsampling: Soil Sampling Design Methods","text":"Create strata equal size:","code":"samples <- ss_coverage_equal_area(study_area, n_strata = 25, n_try = 5)"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"composite-sampling","dir":"","previous_headings":"Sampling Methods","what":"Composite Sampling","title":"soilsampling: Soil Sampling Design Methods","text":"combining samples multiple locations:","code":"# Create 3 composite samples from 20 equal-area strata samples <- ss_composite(study_area, n_strata = 20, n_composites = 3) ss_plot(samples)  # Different symbols for each composite"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"maxvol-optimal-design-sampling","dir":"","previous_headings":"Sampling Methods","what":"Maxvol Optimal Design Sampling","title":"soilsampling: Soil Sampling Design Methods","text":"Feature-based sampling using D-optimal experimental design maximize diversity: maxvol algorithm selects locations maximize determinant (volume) feature submatrix, ensuring maximum diversity feature space. particularly effective : - Features explain soil-forming factors - need deterministic (non-random) point selection - want optimal coverage samples","code":"# Create a grid with terrain features strata <- ss_stratify(study_area, n_strata = 100, n_try = 5) cells_sf <- strata$cells  # Add terrain features (in practice, extract from DEM) coords <- st_coordinates(cells_sf) cells_sf$elevation <- coords[,2] + rnorm(nrow(coords), 0, 5) cells_sf$slope <- abs(rnorm(nrow(coords), 5, 2)) cells_sf$twi <- rnorm(nrow(coords), 8, 1.5)  # Select 20 optimal samples based on features samples <- ss_maxvol(   cells_sf,   n = 20,   features = c(\"elevation\", \"slope\", \"twi\"),   min_dist = 5,        # Minimum distance between samples   normalize = TRUE,    # Normalize features to equal scales   add_coords = TRUE    # Include coordinates as features )  ss_plot_samples(samples)"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"assessing-stratification-quality","dir":"","previous_headings":"","what":"Assessing Stratification Quality","title":"soilsampling: Soil Sampling Design Methods","text":"package provides validation metrics assess quality stratification:","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"coverage-efficiency","dir":"","previous_headings":"Assessing Stratification Quality","what":"Coverage Efficiency","title":"soilsampling: Soil Sampling Design Methods","text":"Evaluate uniformly cells distributed across strata: Output metrics: - CV (Coefficient Variation): Lower values indicate uniform distribution - Min/Max Ratio: Ratio smallest largest stratum (1.0 = perfect equality) - Gini Coefficient: Standard inequality measure (0 = perfect equality) - Efficiency Score: Qualitative assessment (Excellent/Good/Fair/Poor) Comparing stratification methods:","code":"# Create stratification strata <- ss_stratify(study_area, n_strata = 25, n_try = 5)  # Assess coverage efficiency efficiency <- ss_coverage_efficiency(strata) print(efficiency) # Regular stratification strata_regular <- ss_stratify(study_area, n_strata = 20, n_try = 5)  # Equal-area stratification strata_equal <- ss_stratify(study_area, n_strata = 20,                              equal_area = TRUE, n_try = 5)  # Compare efficiency eff_regular <- ss_coverage_efficiency(strata_regular) eff_equal <- ss_coverage_efficiency(strata_equal)  cat(\"Regular CV:\", eff_regular$cv, \"\\n\") cat(\"Equal-area CV:\", eff_equal$cv, \"\\n\") # Equal-area should have much lower CV (< 0.05 vs 0.15-0.30)"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"distance-statistics","dir":"","previous_headings":"Assessing Stratification Quality","what":"Distance Statistics","title":"soilsampling: Soil Sampling Design Methods","text":"Compute distance cells samples stratum centroids: Output (per stratum): - Mean, SD, min, max, median distances centroid - Helps identify dispersed compact strata - Default: squared distances (consistent MSSD metric) Use cases: - Compare different stratification runs (n_try values) - Verify equal-area maintains compactness - Identify strata unusual geometry","code":"# For stratification dist_summary <- ss_distance_summary(strata) print(dist_summary)  # For samples (works with coverage or stratified samples) samples <- ss_coverage(strata) dist_samples <- ss_distance_summary(samples, actual_distance = TRUE) print(dist_samples)"},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"working-with-shapefiles","dir":"","previous_headings":"","what":"Working with Shapefiles","title":"soilsampling: Soil Sampling Design Methods","text":"","code":"# Read study area study_area <- st_read(\"path/to/study_area.shp\")  # Create sampling design set.seed(42) samples <- ss_coverage(study_area, n_strata = 50, n_try = 10)  # Export as CSV coords <- ss_to_data_frame(samples) write.csv(coords, \"sampling_points.csv\", row.names = FALSE)  # Export as GeoPackage samples_sf <- ss_to_sf(samples) st_write(samples_sf, \"sampling_points.gpkg\")"},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"algorithm-details","dir":"","previous_headings":"","what":"Algorithm Details","title":"soilsampling: Soil Sampling Design Methods","text":"package uses pure R implementations k-means algorithms: Transfer Algorithm (default): Standard k-means iteratively transfers cells nearer cluster centers. Creates compact potentially unequal-sized strata. Swop Algorithm (equal_area = TRUE): Modified k-means swaps cells clusters maintain equal sizes optimizing compactness. algorithms minimize Mean Squared Shortest Distance (MSSD) cells assigned cluster centroids.","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"tips-for-best-results","dir":"","previous_headings":"","what":"Tips for Best Results","title":"soilsampling: Soil Sampling Design Methods","text":"Use multiple tries: Set n_try = 10 higher avoid local optima Set seed: Use set.seed() reproducible results Adjust resolution: Use n_cells parameter control grid density Check convergence: output includes converged flag Validate stratification: Use ss_coverage_efficiency() ensure uniform strata Compare alternatives: Test different n_strata values assess efficiency","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"soilsampling: Soil Sampling Design Methods","text":"de Gruijter, J.J., Brus, D.J., Bierkens, M.F.P., Knotters, M. (2006). Sampling Natural Resource Monitoring. Springer, Berlin. Walvoort, D.J.J., Brus, D.J., de Gruijter, J.J. (2010). R package spatial coverage sampling random sampling compact geographical strata k-means. Computers & Geosciences 36, 1261-1267. DOI: 10.1016/j.cageo.2010.04.005 Petrovskaia, N., Korveh, K., Maas, E. (2021). Optimal soil sampling design based maxvol algorithm. Geoderma 381, 114733. DOI: 10.1016/j.geoderma.2020.114733","code":""},{"path":"https://ccarbajal16.github.io/soilsampling/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"soilsampling: Soil Sampling Design Methods","text":"GPL (>= 3)","code":""}]
